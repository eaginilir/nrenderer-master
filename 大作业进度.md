# 光线跟踪核心算法改进 - 大作业进度

## 项目概述

基于 NRenderer 框架的光线跟踪算法改进项目。

## 框架现有实现

### 渲染算法

| 组件                  | 位置                              | 说明                                 |
| --------------------- | --------------------------------- | ------------------------------------ |
| Simple Path Tracing   | `components/simple_path_tracing/` | 基踪础路径追，仅支持 Lambertian 材质 |
| Ray Cast              | `components/ray_cast/`            | 光线投射 + Phong 直接光照            |
| Ray Tracing + KD-Tree | `components/ray_tracing_KDTree/`  | 带 KD-Tree 加速的光线追踪            |
| Photon Mapping        | `components/photon_mapping/`      | 光子映射框架                         |

### 材质系统

| 类型                | type 值 | 状态      |
| ------------------- | ------- | --------- |
| Lambertian (漫反射) | 0       | ✅ 已实现 |
| Phong               | 1       | ✅ 已实现 |
| Dielectric (绝缘体) | 2       | ❌ 待实现 |
| Conductor (导体)    | 3       | ❌ 待实现 |
| Plastic (塑料)      | 4       | ❌ 待实现 |

### 光源类型

| 类型                      | 状态      |
| ------------------------- | --------- |
| PointLight (点光源)       | ✅ 已支持 |
| AreaLight (面光源)        | ✅ 已支持 |
| DirectionalLight (方向光) | ✅ 已支持 |
| SpotLight (聚光灯)        | ✅ 已支持 |
| Environment Map           | ✅ 已实现 |

### 加速结构

| 结构    | 状态      |
| ------- | --------- |
| KD-Tree | ✅ 已实现 |
| BVH     | ❌ 待实现 |

### 采样器

| 采样器          | 位置        | 状态      |
| --------------- | ----------- | --------- |
| UniformInSquare | `samplers/` | ✅ 已实现 |
| UniformInCircle | `samplers/` | ✅ 已实现 |
| Hemisphere      | `samplers/` | ✅ 已实现 |
| Cosine-weighted | -           | ❌ 待实现 |

---

## 计划改进项

### 基础要求 (BASE 40%)

- [ ] **导体材质 (Conductor)**

  - 镜面反射
  - Fresnel 项计算

- [ ] **绝缘体材质 (Dielectric)**

  - 折射 (Snell 定律)
  - Schlick 近似

- [ ] **重要性采样优化**
  - Cosine-weighted 半球采样

### BONUS 项 (最高 20%)

- [ ] GGX 微表面模型
- [ ] Next Event Estimation (NEE)
- [x] Environment Map 光源
- [ ] BVH 加速结构

---

## 开发记录

| 日期 | 完成内容               |
| ---- | ---------------------- |
| -    | 项目分析，确定改进方向 |
| -    | 实现 Environment Map 路径追踪渲染器 |

---

## 参考资料

- [PBRT Book](https://pbr-book.org/)
- 课程 PPT
